# ================================================================
# Server Configuration
# ================================================================
# Bind the Play HTTP server to all network interfaces
play.server.http.address = "0.0.0.0"

# Application port (can be overridden via env PLAY_SERVER_PORT or -Dplay.server.http.port)
play.server.http.port = ${?PLAY_SERVER_PORT}
play.server.http.port = 9001

# Security filter chain (JWT Auth Filter included)
play.http.filters = "security.Filters"

# Enable custom DI module (schedulers, Kafka producer, etc.)
play.modules.enabled += "modules.Module"


# ================================================================
# Notification Settings
# ================================================================
notifications {
  # If true, notifications are pushed to Kafka.
  # Set NOTIFICATIONS_USE_KAFKA=true in Docker/compose to enable.
  useKafka = ${?NOTIFICATIONS_USE_KAFKA}
  useKafka = false

  # Maximum number of retry attempts before marking a notification as failed
  maxAttempts = ${?NOTIFICATIONS_MAX_ATTEMPTS}
  maxAttempts = 3
}

# Scheduler for Task Notification Engine (overridable via envs)
task.scheduler {
  # Delay before first scheduler run
  initialDelay = ${?TASK_SCHEDULER_INITIAL_DELAY}
  initialDelay = 15s

  # Interval between scheduler cycles
  interval = ${?TASK_SCHEDULER_INTERVAL}
  interval = 5m
}


# ================================================================
# CORS Configuration
# ================================================================
# Enable Play CORS filter
play.filters.enabled += "play.filters.cors.CORSFilter"

play.filters.cors {
  # CORS applies to all /api routes
  pathPrefixes = ["/api"]

  # Allowed origins can be supplied via env CORS_ALLOWED_ORIGINS (a HOCON list)
  # Example in docker-compose: CORS_ALLOWED_ORIGINS='["https://app.example","https://admin.example"]'
  allowedOrigins = ${?CORS_ALLOWED_ORIGINS}
  # default to allow all (for dev; lock down in prod)
  allowedOrigins = ["*"]

  # Allowed HTTP methods
  allowedHttpMethods = ["GET", "POST", "PUT", "DELETE", "PATCH", "OPTIONS"]

  # Allowed headers sent by the client
  allowedHttpHeaders = ["Accept", "Origin", "Content-Type", "Authorization", "X-Auth-Token"]

  # Cache preflight OPTIONS response for 3 days
  preflightMaxAge = 3 days
}


# ================================================================
# Database (MySQL + Slick) Configuration
# ================================================================
slick.dbs.default.profile = "slick.jdbc.MySQLProfile$"
slick.dbs.default.db.driver = "com.mysql.cj.jdbc.Driver"

# MySQL connection URL (override with DB_URL env)
slick.dbs.default.db.url = ${?DB_URL}
slick.dbs.default.db.url = "jdbc:mysql://azuremysql8823.mysql.database.azure.com:3306/kumar"

# Database credentials (read from env when provided)
slick.dbs.default.db.user = ${?DB_USER}
slick.dbs.default.db.user = "mysqladmin"

slick.dbs.default.db.password = ${?DB_PASSWORD}
slick.dbs.default.db.password = "Password@12345"

# Automatically run database evolutions without prompts
play.evolutions.db.default.autoApply = true


# ================================================================
# JWT Configuration
# ================================================================
jwt {
  # Secret key used to sign JWT tokens (must be private)
  secret = ${?JWT_SECRET}
  secret = "event-management"

  # Issuer used when generating and validating tokens
  issuer = ${?JWT_ISSUER}
  issuer = "event-management"

  # Token expiry time (seconds). 86400 = 24 hours
  expiration = ${?JWT_EXPIRATION}
  expiration = 86400
}


# ================================================================
# Play Application Secret (Important for Production)
# ================================================================
# Use env PLAY_HTTP_SECRET in containers/prod. Fallback only for local/dev.
play.http.secret.key = ${?PLAY_HTTP_SECRET}
play.http.secret.key = "b0f4f35a4f9c4e8a9e8d1c7f3a8b2c5d7f9e1a3c4b6d8f0e2a4c6e8f0a2b4c"


# ================================================================
# Kafka Configuration
# ================================================================
kafka {
  # Kafka bootstrap servers (override with KAFKA_BOOTSTRAP_SERVERS in Docker)
  bootstrap.servers = ${?KAFKA_BOOTSTRAP_SERVERS}
  bootstrap.servers = "localhost:9092"

  topics {
    # Topic for event-management notifications (override with KAFKA_TOPIC_EVENTMANAGEMENT)
    eventManagement = ${?KAFKA_TOPIC_EVENTMANAGEMENT}
    eventManagement = "eventManagement"
  }

  producer {
    # Acknowledgment mode (override with KAFKA_PRODUCER_ACKS)
    acks = ${?KAFKA_PRODUCER_ACKS}
    acks = "all"

    # Retry attempts (override with KAFKA_PRODUCER_RETRIES)
    retries = ${?KAFKA_PRODUCER_RETRIES}
    retries = 3

    # Linger (override with KAFKA_PRODUCER_LINGER_MS)
    linger.ms = ${?KAFKA_PRODUCER_LINGER_MS}
    linger.ms = 5
  }
}
